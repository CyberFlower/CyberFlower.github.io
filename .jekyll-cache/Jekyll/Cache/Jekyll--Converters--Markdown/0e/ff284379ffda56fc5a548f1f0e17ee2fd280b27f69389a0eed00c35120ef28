I" <p>Fast Fourier Transform (FFT) Algorithm</p>

<hr />

<p>ì¼ë‹¨ ì œ ê¸€ì—ì„œëŠ” FFT ê´€ë ¨ ì•Œê³ ë¦¬ì¦˜ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ìµœì†Œí•œì˜ ì§€ì‹ë§Œì„ ì†Œê°œí•˜ê³  ìˆìŒì„ ì•Œë¦½ë‹ˆë‹¤. ë³´ë‹¤ ë” ì—„ë°€í•˜ê³  ì •í™•í•œ ìˆ˜í•™ì ì¸ ë‚´ìš©ì„ ì›í•˜ì‹ ë‹¤ë©´ ë‹¤ë¥¸ ë¸”ë¡œê·¸ë¥¼ ë³´ì…”ì•¼ í•´ìš”!!</p>

<p>ë§ì´ ì–´ë ¤ìš´ ì•Œê³ ë¦¬ì¦˜ì´ì˜€ê³ , ë”°ë¼ì„œ ì •ë§ ë§ì€ ì¶œì²˜ë¥¼ ì°¸ê³ í•˜ì˜€ìŠµë‹ˆë‹¤. ì£¼ë¡œ ansemddle97 ì„ ë°°ë‹˜ì˜ ì„¤ëª…ê³¼ ì½”ë“œ, <a href="https://topology-blog.tistory.com/6">https://topology-blog.tistory.com/6</a> ë¸”ë¡œê·¸ì˜ ì„¤ëª…ê³¼ ì¼ë¶€ ì½”ë“œ, <a href="https://casterian.net/archives/297">https://casterian.net/archives/297</a>ì˜ ìˆ˜í•™ ì„¤ëª…ë“¤ì„ ë§¤ìš° ë§ì´ ì°¸ê³ í•˜ì˜€ìŒì„ ë¯¸ë¦¬ ë°í™ë‹ˆë‹¤. (ansemddle97 ì„ ë°°ë‹˜ ëŠ˜ ê°ì‚¬ë“œë ¤ìš”!!)</p>

<p>í•„ìš”í•œ ìˆ˜í•™ì  ì§€ì‹ì„ ì‹œì‘ìœ¼ë¡œ FFT ì•Œê³ ë¦¬ì¦˜ ì†Œê°œë¥¼ ì‹œì‘í•˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</p>

<hr />

<h3 id="fft-ê°œê´€">FFT ê°œê´€</h3>

<hr />

<p>ì•Œê³ ë¦¬ì¦˜ì—ì„œ FFTëŠ” í•©ì„±ê³±(convolution)ì„ ë¹ ë¥´ê²Œ êµ¬í•˜ëŠ”ë° ìœ ë¦¬í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ polynomialí•œ ë‘ ë‹¤í•­ì‹ì˜ ê³±ì„ ìƒê°í•´ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p>$ a_0x^0+a_1x^1+â€¦+a_nx^n $ ê³¼ $ b_0x^0+b_1x^1+â€¦+b_mx^m $ì„ ê³±í•˜ë ¤ë©´ ì‹œê°„ë³µì¡ë„ê°€ $ O(nm) $ ì´ ë©ë‹ˆë‹¤. í•˜ì§€ë§Œ FFTë¥¼ ì‚¬ìš©í•œë‹¤ë©´ $ O(nlogn), if(n&gt;m) $ì˜ ì‹œê°„ë³µì¡ë„ë¡œ í•´ê²°í•  ìˆ˜ ìˆê²Œ ë©ë‹ˆë‹¤.</p>

<p>ì´ì œ ìœ„ì˜ ë‘ ë‹¤í•­ì‹ì„ ë¹ ë¥´ê²Œ ê³±í•˜ëŠ” ì½”ë“œ ì‘ì„±ì„ ëª©í‘œë¡œ ì„¤ëª…ì„ ì§„í–‰í•˜ê² ìŠµë‹ˆë‹¤.</p>

<hr />

<h3 id="ìˆ˜í•™-ë³´ì¡°ì •ë¦¬">ìˆ˜í•™ ë³´ì¡°ì •ë¦¬</h3>

<hr />
<ul>
  <li>ë³´ì¡°ì •ë¦¬ 1. $ e^{i\theta}=cos\theta+isin\theta $ Â 
Â </li>
  <li>
    <p>ë³´ì¡°ì •ë¦¬ 2. Fourierì˜ ì •ë¦¬Â 
í—ˆìˆ˜ ìˆ˜ì—´ $ \phi_k(n) $ì„</p>

\[\phi_k(n)=\{ {e^{0*ik\theta}}, {e^{1*ik\theta}}, ... ,{e^{(n-1)* ik\theta}} \}\]

    <p>ì´ë¼ê³  í•©ì‹œë‹¤. ($ \theta=\frac{2\pi}{n} $)</p>

    <p>Fourier ì •ë¦¬ì— ì˜í•˜ì—¬ $ \phi_0(n), \phi_1(n), â€¦ \phi_{n-1}(n) $ ì„ ê¸°ì €ë¡œ í•˜ì—¬ ëª¨ë“  nì°¨ í•©ì„±í•¨ìˆ˜ë¥¼ í‘œí˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. (ìœ¼ì•…) Â </p>
  </li>
  <li>
    <p>ë³´ì¡°ì •ë¦¬ 3. ë³µì†Œë²¡í„° $ \phi_{k1}(n) $,$ \phi_{k2}(n)$ ì—ì„œ $ k_1 $ ê³¼ $ k_2 $ ê°€ ë‹¤ë¥´ë©´ ë‘ ë³µì†Œë²¡í„°ëŠ” ì§êµí•©ë‹ˆë‹¤.</p>

    <p>pf) ë³µì†Œë²¡í„°ì˜ ë‚´ì ì„ í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>

    <p>\(\sum_{j=0}^{j=n-1}{e^{j*i(k_1-k_2)\theta}}= \frac{e^{ni(k_1-k_2)\theta}-1}{e^{ik\theta}-1}=0\) 
ì´ë¯€ë¡œ ì¦ëª…ë˜ì—ˆìŠµë‹ˆë‹¤.
Â </p>
  </li>
  <li>ë³´ì¡°ì •ë¦¬ 4. í“¨ë¦¬ì— ë³€í™˜
ìˆ˜ì—´ $ a={ a_0, â€¦ ,a_{n-1} } $ ì´ë¼ê³  í•˜ë©´ $\phi_k$ì— ëŒ€í•œ í“¨ë¦¬ì— ë³€í™˜ì€ 
\(A_k=\sum_{j=0}^{j=n-1} a_je^{j*ik\theta}\) 
ë¼ê³  í•˜ê³ , $ A={A_0,â€¦A_{n-1}} $ ì´ë¼ í•˜ê² ìŠµë‹ˆë‹¤. Â 
Â </li>
  <li>ë³´ì¡°ì •ë¦¬ 5. ì—­í–‰ë ¬
ìœ„ì—ì„œ ì œì‹œí•œ í“¨ë¦¬ì— ë³€í™˜ í–‰ë ¬ì„ ìƒì„±í•  ìˆ˜ ìˆìœ¼ë©°, ì´ í–‰ë ¬ì€ ì—­í–‰ë ¬ì´ ì¡´ì¬í•©ë‹ˆë‹¤.
<img src="/img/2020-05-19-fft_mat.gif" alt="mat" />
<img src="/img/2020-05-19-fft_inv_mat.gif" alt="mat" />
ì„ í˜•ëŒ€ìˆ˜í•™ì˜ ë‚´ìš©ì´ë‹ˆ ì¦ëª…ì€ ìƒëµí•˜ê² ìŠµë‹ˆë‹¤.</li>
</ul>

<hr />

<h3 id="ì•Œê³ ë¦¬ì¦˜-ê°œê´€">ì•Œê³ ë¦¬ì¦˜ ê°œê´€</h3>

<hr />
<ol>
  <li>a+b ì´ìƒ ì ë‹¹íˆ í° 2ì˜ ê±°ë“­ì œê³±ê¼´ì˜ nì„ ì°¾ê³ , a,bë¥¼ ê¸¸ì´ê°€ nì¸ ìˆ˜ì—´ë¡œ ë³€í™˜(0 ì¶”ê°€)</li>
  <li>ìˆ˜ì—´ a,bë¥¼ A,Bë¡œ ë³€í™˜</li>
  <li>Cë¥¼ O(n)ìœ¼ë¡œ ê³„ì‚° (ë³´ì¡°ì •ë¦¬ 3ì„ í†µí•´ $C_k=A_kB_k$ ì„ì„ ì•Œ ìˆ˜ ìˆìŒ)</li>
  <li>Cë¥¼ cë¡œ ë³€í™˜ (ë³´ì¡°ì •ë¦¬ 5)</li>
</ol>

<p>í¸ì˜ë¥¼ ìœ„í•´ì„œ nì€ 2ì˜ ê±°ë“­ì œê³±ì„ ê°€ì •í•©ë‹ˆë‹¤. nì´ a,bë³´ë‹¤ ê¸¸ë•ŒëŠ” 0ì„ ì±„ì›Œë„£ìœ¼ë©´ ë˜ê³ , nì´ 1ì¼ë•ŒëŠ” c=a*bì´ë¯€ë¡œ ê±±ì •í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.</p>

<p>nì´ ì§ìˆ˜ì´ë¯€ë¡œ</p>

\[A_k= 
\sum_{j=0}^{j=n-1} a_je^{j*ik \theta} = 
\sum_{j=0}^{j=n/2-1} a_{2j}e^{j*ik \theta_1} + e^{ik \theta} 
\sum_{j=0}^{j=n-1} a_{2j+1}e^{j*ik \theta_1}\]

<p>ë¼ëŠ” ì‹ì´ ë‚˜ì˜µë‹ˆë‹¤. ( $\theta_1=2\pi/({n/2}) $ )</p>

<p>ì „ì²´ì™€ ë¶€ë¶„ì˜ ëª¨ì–‘ì´ ë¹„ìŠ·í•˜ë¯€ë¡œ ìš°ë¦¬ëŠ” ì´ ì‹ì„ í†µí•´ì„œ ë¶„í• ì •ë³µì„ ì´ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜, $A_k=A_{(k+n/2)}$ë¼ëŠ” ì‹ë„ ìœ ì¶”í•  ìˆ˜ ìˆê² êµ°ìš”.</p>

<ol>
  <li>ë°©ê¸ˆ ì†Œê°œí•œ ì‹ì„ ì´ìš©í•˜ì—¬ ë¶„í• ì •ë³µì„ ì§„í–‰í•©ë‹ˆë‹¤.</li>
</ol>

<p>ìë¦¬ìˆ˜ê°€ 300,000 ì •ë„ ë˜ëŠ” í° ë‘ìˆ˜ë¥¼ ê³±í•˜ëŠ” ê²ƒë„ FFTë¡œ í•´ê²°ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. xëŒ€ì‹  10ì„ ì¸ìë¡œ ê°–ëŠ” ë‹¤í•­ì‹ì´ë¼ê³  ìƒê°í•˜ë©´ ë˜ê¸° ë•Œë¬¸ì´ì£ .</p>

<p><a href="https://www.acmicpc.net/problem/13277">í° ìˆ˜ ê³±ì…ˆ</a>, <a href="https://www.acmicpc.net/problem/15576">í° ìˆ˜ ê³±ì…ˆ(2)</a>ë¥¼ í’€ì–´ë³´ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="c1">// ë³µì†Œìˆ˜ ìë£Œí˜•ì„ ì •ì˜</span>
<span class="k">typedef</span> <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">vi</span><span class="p">;</span>
<span class="k">typedef</span> <span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">base</span><span class="p">;</span>
<span class="n">string</span> <span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">;</span>
<span class="k">class</span> <span class="nc">FFT_multi</span><span class="p">{</span>
<span class="nl">private:</span>
  <span class="kt">int</span> <span class="n">n</span><span class="p">,</span><span class="n">sn</span><span class="p">,</span><span class="n">tn</span><span class="p">;</span>
<span class="nl">public:</span>
  <span class="n">FFT_multi</span><span class="p">(){</span>
    <span class="n">sn</span><span class="o">=</span><span class="n">s</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
    <span class="n">tn</span><span class="o">=</span><span class="n">t</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
    <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">n</span><span class="o">&lt;</span><span class="n">sn</span><span class="o">+</span><span class="n">tn</span><span class="p">)</span> <span class="n">n</span><span class="o">&lt;&lt;=</span><span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="kt">void</span> <span class="n">fft</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">base</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">dst</span><span class="p">,</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">base</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">arr</span><span class="p">,</span> <span class="kt">int</span> <span class="n">ln</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">inv</span><span class="p">){</span>
    <span class="n">dst</span><span class="p">.</span><span class="n">resize</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">ln</span><span class="o">==</span><span class="mi">1</span><span class="p">){</span>
      <span class="n">dst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
      <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="n">base</span><span class="o">&gt;</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">ln</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
      <span class="n">a</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">]);</span>
      <span class="n">b</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="n">base</span><span class="o">&gt;</span> <span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">;</span>
    <span class="n">fft</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">ln</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">inv</span><span class="p">);</span>
    <span class="n">fft</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">ln</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">inv</span><span class="p">);</span>
    <span class="kt">double</span> <span class="n">angle</span><span class="o">=</span><span class="n">inv</span><span class="o">?</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">M_PI</span><span class="o">/</span><span class="n">ln</span><span class="p">)</span><span class="o">:</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">M_PI</span><span class="o">/</span><span class="n">ln</span><span class="p">);</span>
    <span class="n">base</span> <span class="n">w</span><span class="o">=</span><span class="n">base</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">));</span>
    <span class="n">base</span> <span class="n">twiddle_factor</span><span class="o">=</span><span class="n">base</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">ln</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
      <span class="n">dst</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">twiddle_factor</span><span class="o">*</span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
      <span class="n">dst</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">ln</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">twiddle_factor</span><span class="o">*</span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
      <span class="n">twiddle_factor</span><span class="o">*=</span><span class="n">w</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="n">vi</span> <span class="n">multiply</span><span class="p">(){</span>
    <span class="n">vi</span> <span class="n">ret</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="n">base</span><span class="o">&gt;</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">&lt;</span><span class="n">sn</span><span class="p">)</span> <span class="n">x</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">base</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">sn</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="sc">'0'</span><span class="p">,</span><span class="mi">0</span><span class="p">));</span>
        <span class="k">else</span> <span class="n">x</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">base</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">));</span>
        <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">&lt;</span><span class="n">tn</span><span class="p">)</span> <span class="n">y</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">base</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">tn</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="sc">'0'</span><span class="p">,</span><span class="mi">0</span><span class="p">));</span>
        <span class="k">else</span> <span class="n">y</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">base</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="n">base</span><span class="o">&gt;</span> <span class="n">v1</span><span class="p">,</span><span class="n">v2</span><span class="p">,</span><span class="n">ans</span><span class="p">;</span>
    <span class="n">fft</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="nb">true</span><span class="p">);</span>
    <span class="n">fft</span><span class="p">(</span><span class="n">v2</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="nb">true</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">v1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">v1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span> <span class="n">v2</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="n">fft</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span><span class="n">v1</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="nb">false</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/=</span><span class="n">n</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">ret</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">round</span><span class="p">(</span><span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">real</span><span class="p">());</span>
        <span class="n">ret</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">+=</span><span class="n">ret</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="mi">10</span><span class="p">;</span>
        <span class="n">ret</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">%=</span><span class="mi">10</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">reverse</span><span class="p">(</span><span class="n">ret</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="n">ret</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>    
    <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
  <span class="n">ios_base</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span> <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="nb">NULL</span><span class="p">);</span>
  <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">s</span><span class="o">&gt;&gt;</span><span class="n">t</span><span class="p">;</span>
  <span class="k">if</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">compare</span><span class="p">(</span><span class="s">"0"</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span> <span class="o">||</span> <span class="n">t</span><span class="p">.</span><span class="n">compare</span><span class="p">(</span><span class="s">"0"</span><span class="p">)</span><span class="o">==</span><span class="sc">'0'</span><span class="p">){</span>
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">FFT_multi</span> <span class="n">fft</span><span class="o">=</span><span class="n">FFT_multi</span><span class="p">();</span>
  <span class="n">vi</span> <span class="n">ans</span><span class="o">=</span><span class="n">fft</span><span class="p">.</span><span class="n">multiply</span><span class="p">();</span>
    <span class="kt">int</span> <span class="n">idx</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">ans</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="n">idx</span><span class="o">++</span><span class="p">;</span>  
  <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">idx</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">ans</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>í•˜ì§€ë§Œ ì´ ì½”ë“œëŠ” ì¡°ê¸ˆ ë¬¸ì œê°€ ìˆì—ˆìŠµë‹ˆë‹¤. ì‹œê°„ë³µì¡ë„ëŠ” nlognì´ ë§ì§€ë§Œ, vectorì˜ ìƒì„±ì´ ë„ˆë¬´ ë§ì•„ ìƒê°ë³´ë‹¤ ì‹œê°„ì´ ì˜¤ë˜ ê±¸ë¦¬ë”êµ°ìš”. ì‹¤ì œë¡œ ìœ„ ì½”ë“œëŠ” í° ìˆ˜ ê³±ì…ˆì—ì„œëŠ” 2.5ì´ˆ í†µê³¼í•˜ì§€ë§Œ í° ìˆ˜ ê³±ì…ˆ(2)ì—ì„œëŠ” ì‹œê°„ì œí•œì´ 2ì´ˆì¸ì§€ë¼ í†µê³¼í•˜ì§€ ëª»í•©ë‹ˆë‹¤.</p>

<hr />

<h3 id="ë¹„ì¬ê·€-ìµœì í™”">ë¹„ì¬ê·€ ìµœì í™”</h3>

<hr />

<p>ì¬ê·€í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì§€ ì•Šê³  FFTë¥¼ êµ¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ ìœ„í•˜ì—¬ ë˜ í•˜ë‚˜ì˜ ë³´ì¡°ì •ë¦¬ë¥¼ ì†Œê°œí•˜ê² ìŠµë‹ˆë‹¤.</p>

<ul>
  <li>ë³´ì¡°ì •ë¦¬ 6. í™€ìˆ˜ ë²ˆì§¸ ìˆ˜ë¥¼ ì•ìœ¼ë¡œ, ì§ìˆ˜ ë²ˆì§¸ ìˆ˜ë¥¼ ë’¤ë¡œ ë¹¼ëŠ” ë¶„í• ì •ë³µ(=fft ë¶„í• ì •ë³µ)ì—ì„œ ië²ˆì§¸ ìˆ˜ëŠ” k($log_2(n)$) ìë¦¿ìˆ˜ë¥¼ ë’¤ì§‘ì€ ìˆ˜ jë²ˆì§¸ ìœ„ì¹˜ë¡œ ì¬ë°°ì—´ëœë‹¤.</li>
</ul>

<p>ì¦ëª…ì€ ìˆ˜í•™ì  ê·€ë‚©ë²•ì„ ì´ìš©í•˜ë©´ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ë§Œâ€¦ ë„ˆë¬´ ê¸¸ì–´ì§€ë‹ˆ ì—¬ê¸°ì„œëŠ” êµ³ì´ ì„œìˆ í•˜ì§€ ì•Šê² ìŠµë‹ˆë‹¤. ìœ„ì—ì„œ ë§ì”€ë“œë ¸ë˜ casterianë‹˜ ë¸”ë¡œê·¸ë¥¼ ì°¸ê³ í•˜ì‹œë©´ ì¢‹ì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.</p>

<p>ë‚˜ë¨¸ì§€ëŠ” ì½”ë“œë¥¼ ë³´ê³  ì„¤ëª…ë“œë¦¬ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">typedef</span> <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">vi</span><span class="p">;</span>
<span class="k">typedef</span> <span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">base</span><span class="p">;</span>
<span class="n">string</span> <span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">;</span>
<span class="k">class</span> <span class="nc">FFT_multi</span><span class="p">{</span>
<span class="nl">private:</span>
  <span class="kt">int</span> <span class="n">n</span><span class="p">,</span><span class="n">kk</span><span class="p">,</span><span class="n">sn</span><span class="p">,</span><span class="n">tn</span><span class="p">;</span>
  <span class="c1">// xì—ì„œ kê°œì˜ bitë¥¼ reverseí•˜ëŠ” í•¨ìˆ˜</span>
  <span class="kr">inline</span> <span class="kt">int</span> <span class="n">bit_reverse</span><span class="p">(</span><span class="k">const</span> <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">k</span><span class="p">){</span>
    <span class="kt">int</span> <span class="n">res</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">k</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
      <span class="n">res</span><span class="o">^=</span><span class="p">((</span><span class="n">x</span><span class="o">&gt;&gt;</span><span class="n">i</span><span class="p">)</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">res</span><span class="p">;</span>
  <span class="p">}</span>
<span class="nl">public:</span>
  <span class="n">FFT_multi</span><span class="p">(){</span>
    <span class="n">sn</span><span class="o">=</span><span class="n">s</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
    <span class="n">tn</span><span class="o">=</span><span class="n">t</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
    <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">kk</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">n</span><span class="o">&lt;</span><span class="n">sn</span><span class="o">+</span><span class="n">tn</span><span class="p">)</span> <span class="n">n</span><span class="o">&lt;&lt;=</span><span class="mi">1</span><span class="p">,</span> <span class="n">kk</span><span class="o">++</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="kt">void</span> <span class="n">fft</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">base</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">arr</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">inv</span><span class="p">){</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
      <span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="n">bit_reverse</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">kk</span><span class="p">);</span>
      <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">&lt;</span><span class="n">j</span><span class="p">)</span> <span class="n">swap</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">arr</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="c1">// ì¬ê·€í•¨ìˆ˜ì˜ ë§ˆì§€ë§‰ë¶€í„° ë°˜ë³µë¬¸ì„ ëŒë¦¬ì. ì¦‰, ì‚¬ì´ì¦ˆê°€ 2ì¼ë•Œë¶€í„°</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;&lt;=</span><span class="mi">1</span><span class="p">){</span>
      <span class="kt">double</span> <span class="n">angle</span><span class="o">=</span><span class="n">inv</span><span class="o">?</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">M_PI</span><span class="o">/</span><span class="n">i</span><span class="p">)</span><span class="o">:</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">M_PI</span><span class="o">/</span><span class="n">i</span><span class="p">);</span>
      <span class="n">base</span> <span class="n">w</span><span class="o">=</span><span class="n">base</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">));</span>
      <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">j</span><span class="o">+=</span><span class="n">i</span><span class="p">){</span>
        <span class="n">base</span> <span class="n">twiddle_factor</span><span class="o">=</span><span class="n">base</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">k</span><span class="o">&lt;</span><span class="n">i</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span><span class="n">k</span><span class="o">++</span><span class="p">){</span>
          <span class="n">base</span> <span class="n">tmp</span><span class="o">=</span><span class="n">twiddle_factor</span><span class="o">*</span><span class="n">arr</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="o">+</span><span class="n">i</span><span class="o">/</span><span class="mi">2</span><span class="p">];</span>
          <span class="n">arr</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="o">+</span><span class="n">i</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="n">arr</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="p">]</span><span class="o">-</span><span class="n">tmp</span><span class="p">;</span>
          <span class="n">arr</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">arr</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="p">]</span><span class="o">+</span><span class="n">tmp</span><span class="p">;</span>
          <span class="n">twiddle_factor</span><span class="o">*=</span><span class="n">w</span><span class="p">;</span>          
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="n">vi</span> <span class="n">multiply</span><span class="p">(){</span>
    <span class="n">vi</span> <span class="n">ret</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="n">base</span><span class="o">&gt;</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">&lt;</span><span class="n">sn</span><span class="p">)</span> <span class="n">x</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">base</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">sn</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="sc">'0'</span><span class="p">,</span><span class="mi">0</span><span class="p">));</span>
        <span class="k">else</span> <span class="n">x</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">base</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">));</span>
        <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">&lt;</span><span class="n">tn</span><span class="p">)</span> <span class="n">y</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">base</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">tn</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="sc">'0'</span><span class="p">,</span><span class="mi">0</span><span class="p">));</span>
        <span class="k">else</span> <span class="n">y</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">base</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="n">fft</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="nb">true</span><span class="p">);</span>
    <span class="n">fft</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="nb">true</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="n">fft</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="nb">false</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/=</span><span class="n">n</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">ret</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">round</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">real</span><span class="p">());</span>
        <span class="n">ret</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">+=</span><span class="n">ret</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="mi">10</span><span class="p">;</span>
        <span class="n">ret</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">%=</span><span class="mi">10</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">reverse</span><span class="p">(</span><span class="n">ret</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span><span class="n">ret</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>    
    <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">){</span>
  <span class="n">ios_base</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span> <span class="n">cin</span><span class="p">.</span><span class="n">tie</span><span class="p">(</span><span class="nb">NULL</span><span class="p">);</span>
  <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">s</span><span class="o">&gt;&gt;</span><span class="n">t</span><span class="p">;</span>
  <span class="k">if</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">compare</span><span class="p">(</span><span class="s">"0"</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span> <span class="o">||</span> <span class="n">t</span><span class="p">.</span><span class="n">compare</span><span class="p">(</span><span class="s">"0"</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">FFT_multi</span> <span class="n">fft</span><span class="o">=</span><span class="n">FFT_multi</span><span class="p">();</span>
  <span class="n">vi</span> <span class="n">ans</span><span class="o">=</span><span class="n">fft</span><span class="p">.</span><span class="n">multiply</span><span class="p">();</span>
    <span class="kt">int</span> <span class="n">idx</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">ans</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="n">idx</span><span class="o">++</span><span class="p">;</span>  
  <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">idx</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">ans</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>
:ET